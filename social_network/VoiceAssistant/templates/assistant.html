<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Study Assistant</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div id="chat-window">
    <div id="chat-log"></div>
    <button id="activate-btn">ðŸŽ¤ Ð“Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ÑŒ</button>
  </div>

  <script>
    document.getElementById("activate-btn").onclick = async () => {
      const btn = document.getElementById("activate-btn");
      btn.disabled = true;
      btn.textContent = "ðŸŽ¤ ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ°...";

      const res = await fetch("/listen", { method: "POST" });
      const data = await res.json();

      const log = document.getElementById("chat-log");
      data.history.forEach(entry => {
        const div = document.createElement("div");
        div.className = entry.role;
        div.textContent = `${entry.role === 'user' ? 'Ð’Ñ‹' : 'Study'}: ${entry.message}`;
        log.appendChild(div);
      });

      if (data.audio) {
        const audio = new Audio(data.audio);
        audio.play();
      }

      btn.textContent = "ðŸŽ¤ Ð“Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ÑŒ";
      btn.disabled = false;
    }
  </script>
</body>
</html>
