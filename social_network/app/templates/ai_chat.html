<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AI Чат — StudySphere</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/ai_chat.css') }}">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container header-inner">
      <div class="logo">
        <a href="{{ url_for('main.landing') }}">
          <img src="{{ url_for('static', filename='images/logo.svg') }}" alt="StudySphere">
        </a>
        <span class="logo-text">StudySphere</span>
      </div>
      <nav class="nav">
        <a href="{{ url_for('ai_chat_bp.ai_chat') }}" class="active">Чат с ИИ</a>
        <a href="{{ url_for('main.textbook') }}">Учебник</a>
        <a href="{{ url_for('main.show_tasks') }}">Задачи</a>
        <a href="{{ url_for('quizzes_bp.choose') }}">Квизы</a>
        <a href="{{ url_for('main.support') }}">Поддержка</a>
      </nav>
      <div class="auth-buttons">
        <a href="{{ url_for('main.register') }}" class="btn-auth">Регистрация</a>
        <a href="{{ url_for('main.login') }}" class="btn-auth">Вход</a>
      </div>
      <button class="burger" id="burger"><span></span><span></span><span></span></button>
    </div>
  </header>

  <!-- Chat Page -->
  <main class="chat-page container">
    <div class="chat-container">
      <!-- Sidebar: Avatar + Controls -->
      <aside class="chat-sidebar">
        <div class="avatar-card">
          <img id="avatar" src="{{ url_for('static', filename='images/Basic_Avatar.svg') }}" alt="Avatar">
        </div>
        <div class="controls-container">
          <!-- Тип генерации -->
          <select id="generationType" class="mode-btn">
            <option value="text" selected>Генерация текста</option>
            <option value="image">Генерация изображений</option>
          </select>
          <!-- Текстовые провайдеры -->
          <select id="modelType" class="model-btn text-only">
            <option value="Qwen_Qwen_2_5M" title="Эксперт с высочайшей точностью для научных и сложных вопросов.">Qwen_Qwen_2_5M</option>
            <option value="PollinationsAI" title="Быстрый помощник с идеальным балансом скорости и качества.">PollinationsAI</option>
            <option value="Websim" title="Мастер структурирования с хорошо организованными ответами.">Websim</option>
            <option value="Free2GPT" title="Детализированный генератор объемных и подробных ответов.">Free2GPT</option>
            <option value="Qwen_Qwen_2_5" title="Аналитик с безупречной структурой и полнотой изложения.">Qwen_Qwen_2_5</option>
            <option value="ChatGLM" title="Перфекционист качества для случаев, когда точность важнее скорости.">ChatGLM</option>
            <option value="GizAI" title="Многословный рассказчик с обширными, но менее точными ответами.">GizAI</option>
            <option value="Qwen_Qwen_2_72B" title="Шустрый помощник для базовых вопросов и простых запросов.">Qwen_Qwen_2_72B</option>
            <option value="AnyProvider" title="Надежный резервист с хорошей структурой, но медленной работой.">AnyProvider</option>
            <option value="FreeGpt" title="Полиглот с уклоном в китайский, требующий инструкций по языку ответа.">FreeGpt</option>
          </select>
          <!-- Графические провайдеры -->
          <select id="imageModelType" class="model-btn image-only" style="display:none">
            <option value="PollinationsImage" title="Молниеносный художник для быстрого создания визуального контента.">PollinationsImage</option>
            <option value="ImageLabs" title="Универсальный визуализатор с хорошей производительностью.">ImageLabs</option>
            <option value="BlackForestLabs_Flux1Dev" title="Детализированный иллюстратор для запасных случаев.">BlackForestLabs_Flux1Dev</option>
          </select>
          <!-- Улучшенная генерация -->
          <button id="enhancedMode" class="enhanced-btn">Улучшенная генерация</button>
          <!-- Что такое улучшенная генерация -->
          <button id="helpBtn" class="help-btn">Что такое улучшенная генерация?</button>
        </div>
      </aside>

      <!-- Main Chat Area -->
      <section class="chat-main">
        <h2 class="chat-title">Чат с AI-ассистентом</h2>
        <div id="chatMessages" class="chat-messages"></div>
        <div class="input-area">
          <textarea id="messageInput" class="message-input" placeholder="Введите сообщение…"></textarea>
          <button id="sendBtn" class="send-btn">Отправить</button>
        </div>
      </section>
    </div>
  </main>

  <!-- Help Modal -->
  <div id="helpModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Что такое улучшенная генерация?</h3>
        <button class="modal-close" id="closeModal">✖</button>
      </div>
      <div class="modal-body">
        <p><strong>Улучшенная генерация</strong> — это каскад из трёх нейросетей, которые:</p>
        <ul>
          <li><strong>Анализируют</strong> ваш запрос (ChatGLM)</li>
          <li><strong>Генерируют</strong> первый вариант ответа (GizAI)</li>
          <li><strong>Синтезируют</strong> и полируют ответ (Free2GPT)</li>
        </ul>
        <p>Такой симбиоз повышает глубину, точность и согласованность ответа, пусть он займёт на пару секунд больше времени.</p>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container footer-inner">
      <div class="footer-left">
        <a href="{{ url_for('main.landing') }}" class="logo">
          <img src="{{ url_for('static', filename='images/logo.svg') }}" alt="StudySphere" class="footer-logo">
          <span class="logo-text">StudySphere</span>
        </a>
        <p class="copy">© 2025 StudySphere. Все права защищены.</p>
      </div>
      <div class="footer-right">
        <a href="https://github.com/dany-simonov/SS" target="_blank">GitHub</a>
      </div>
    </div>
  </footer>

  <script src="{{ url_for('static', filename='js/ai_chat.js') }}"></script>
</body>
</html>